<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BioTetris ‚Äì Think to Move</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  font-family:system-ui, Arial, sans-serif;
  background:#0b1020;
  color:white;
  display:flex;
  flex-direction:column;
  align-items:center;
}
h1{margin:10px}
.container{display:flex;gap:20px;flex-wrap:wrap;justify-content:center}
canvas{background:#111;border:2px solid #444}
.panel{
  max-width:360px;
  background:#151a33;
  padding:14px;
  border-radius:12px;
}
.choice{
  display:block;
  width:100%;
  margin-top:8px;
  padding:8px;
  background:#2c315c;
  color:white;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
.choice.correct{background:#2ecc71}
.choice.wrong{background:#e74c3c}
.small{font-size:13px;color:#bbb}
.locked{color:#ff7675;font-weight:bold}
.unlocked{color:#2ecc71;font-weight:bold}
</style>
</head>

<body>
<h1>üß¨ BioTetris</h1>
<div class="small">Answer correctly to unlock movement</div>

<div class="container">
<canvas id="game" width="240" height="480"></canvas>

<div class="panel">
<h3>Biology Lock</h3>
<div id="lockState" class="locked">üîí Controls locked</div>
<p id="question">New piece = new question</p>
<div id="choices"></div>
<p id="explain" class="small"></p>
<hr>
<p class="small">
‚å® Controls (when unlocked):<br>
‚Üê ‚Üí move ¬∑ ‚Üë rotate ¬∑ ‚Üì drop ¬∑ Space = hard drop
</p>
</div>
</div>

<script>
/* ===== QUESTIONS FROM YOUR PDF ===== */
const QUESTIONS = [
{
q:"What is an ecosystem?",
c:[
"All living organisms and the non-living environment",
"Only plants",
"Only animals",
"One species"
],
a:0,
e:"Ecosystems include both biotic and abiotic factors."
},
{
q:"Which is an abiotic factor?",
c:["Bacteria","Predators","Temperature","Competition"],
a:2,
e:"Abiotic factors are non-living."
},
{
q:"Which biomolecule is used in respiration?",
c:["Proteins","Lipids","Carbohydrates","Nucleic acids"],
a:2,
e:"Glucose is a carbohydrate."
},
{
q:"Where does aerobic respiration occur?",
c:["Nucleus","Ribosomes","Mitochondria","Cell wall"],
a:2,
e:"Mitochondria produce ATP."
},
{
q:"What is a hypothesis?",
c:[
"A proven fact",
"An educated, testable prediction",
"A guess",
"A conclusion"
],
a:1,
e:"Hypotheses are tested experimentally."
}
];

/* ===== TETRIS ENGINE ===== */
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const COLS=10,ROWS=20,SIZE=24;
let grid=[...Array(ROWS)].map(()=>Array(COLS).fill(0));

const SHAPES=[
[[1,1,1,1]],
[[1,1],[1,1]],
[[0,1,0],[1,1,1]],
[[1,1,0],[0,1,1]],
[[0,1,1],[1,1,0]]
];

let piece;
let controlsLocked=true;
let currentQuestion=null;

function newPiece(){
  controlsLocked=true;
  document.getElementById("lockState").textContent="üîí Controls locked";
  document.getElementById("lockState").className="locked";
  askQuestion();
  const s=SHAPES[Math.floor(Math.random()*SHAPES.length)];
  return{s,x:3,y:0};
}

piece=newPiece();

function collide(px,py,ps){
  for(let y=0;y<ps.length;y++)
  for(let x=0;x<ps[y].length;x++)
  if(ps[y][x]){
    let nx=px+x,ny=py+y;
    if(nx<0||nx>=COLS||ny>=ROWS||grid[ny]?.[nx])return true;
  }
  return false;
}

function merge(){
  piece.s.forEach((r,y)=>r.forEach((v,x)=>{
    if(v)grid[piece.y+y][piece.x+x]=1;
  }));
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  grid.forEach((r,y)=>r.forEach((v,x)=>{
    if(v){
      ctx.fillStyle="#4ef0a3";
      ctx.fillRect(x*SIZE,y*SIZE,SIZE,SIZE);
    }
  }));
  piece.s.forEach((r,y)=>r.forEach((v,x)=>{
    if(v){
      ctx.fillStyle=controlsLocked?"#888":"#ffd166";
      ctx.fillRect((piece.x+x)*SIZE,(piece.y+y)*SIZE,SIZE,SIZE);
    }
  }));
}

function drop(){
  if(!collide(piece.x,piece.y+1,piece.s)){
    piece.y++;
  } else {
    merge();
    piece=newPiece();
    if(collide(piece.x,piece.y,piece.s)){
      alert("Game Over");
      location.reload();
    }
  }
  draw();
}

setInterval(drop,650);

/* ===== CONTROLS (LOCKED UNTIL ANSWER) ===== */
document.addEventListener("keydown",e=>{
  if(controlsLocked) return;
  if(e.key==="ArrowLeft"&&!collide(piece.x-1,piece.y,piece.s))piece.x--;
  if(e.key==="ArrowRight"&&!collide(piece.x+1,piece.y,piece.s))piece.x++;
  if(e.key==="ArrowDown")drop();
  if(e.key==="ArrowUp"){
    const r=piece.s[0].map((_,i)=>piece.s.map(r=>r[i]).reverse());
    if(!collide(piece.x,piece.y,r))piece.s=r;
  }
  if(e.key===" ")while(!collide(piece.x,piece.y+1,piece.s))piece.y++;
  draw();
});

/* ===== QUIZ ===== */
function askQuestion(){
  const q=QUESTIONS[Math.floor(Math.random()*QUESTIONS.length)];
  currentQuestion=q;
  document.getElementById("question").textContent=q.q;
  document.getElementById("explain").textContent="";
  const c=document.getElementById("choices");
  c.innerHTML="";
  q.c.forEach((t,i)=>{
    const b=document.createElement("button");
    b.textContent=t;
    b.className="choice";
    b.onclick=()=>{
      if(i===q.a){
        b.classList.add("correct");
        controlsLocked=false;
        document.getElementById("lockState").textContent="üîì Controls unlocked";
        document.getElementById("lockState").className="unlocked";
      }else{
        b.classList.add("wrong");
      }
      document.getElementById("explain").textContent=q.e;
    };
    c.appendChild(b);
  });
}

draw();
</script>
</body>
</html>
